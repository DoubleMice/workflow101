# Workflow101：从对话式编程到工作流编排

> 一个 Code Review Bot，10 章实战，6 种编排模式。
> 用一个刚好够小的项目，把 Agent、Workflow、Hook、Skill 这些常被提起却不太好上手的概念，串起来跑通一遍。
> 做完之后，你对 AI 编排的理解会从"看过文章"变成"亲手搭过"。

---

## 一个常见的场景

周五下午，同事提了一个 800 行的 PR。安全漏洞要查、性能问题要看、代码风格要审、业务逻辑要对。你把 diff 贴给 AI："帮我 review 一下。"

AI 给了一些建议，但不够深入。追问几轮后，它开始重复自己。最后你还是自己一行一行地看完了。

这其实不是 AI 能力的问题，而是使用方式的问题——一个需要多维度协作的任务，放在单轮对话里确实不太够用。

![一问一答 vs 工作流编排](docs/images/Gemini_Generated_Image_bp1.png)

## 这篇教程在讲什么

[Workflow101](https://workflow101.readthedocs.io) 是一份面向中文开发者的开源实战教程。它的关注点不是"怎么用 AI 写代码"，而是再往前一步：**怎么把多个 AI Agent 组织起来，协作完成一件事**。

大约 3 小时的阅读和动手时间，你会从零构建一个 Code Review Automator：

- 一条命令，4 个专业 Agent 并行审查 PR
- 安全漏洞、性能瓶颈、代码风格、逻辑缺陷，分别由不同 Agent 负责
- 结果自动聚合，生成结构化报告，给出 PASS / NEEDS_WORK / FAIL 裁定
- 可以挂到 git hook 上，commit 时自动触发

不过这个工具本身只是载体。更重要的是构建过程中积累的编排思路——这些思路不绑定特定工具，换个场景一样能用。

![Review Bot 架构流程图](docs/images/Gemini_Generated_Image_bp2.png)

## 从"会用"到"会编排"

开发者使用 AI 的方式大致可以分成三个阶段：

| 阶段 | 模式 | 典型做法 | 瓶颈 |
|:---:|:---:|---------|--------|
| 1 | 一问一答 | 把代码贴给 AI，等回复，手动整合 | 受限于单次对话的上下文和手动操作 |
| 2 | Prompt 工程 | 设计 system prompt，用 few-shot 提升质量 | 单个 Agent 能力有限，复杂任务仍需人工拆解 |
| 3 | 工作流编排 | 多个 Agent 分工协作，自动触发，结果聚合 | 取决于你的设计能力 |

Workflow101 希望帮你从阶段 1 过渡到阶段 3。不是跳过基础，而是在构建项目的过程中，让每个概念都有落地的场景。

![AI 编程三阶段](docs/images/Gemini_Generated_Image_bp3.png)

## 10 章实战，一条主线串起来

整个教程围绕同一个项目展开，每章在前一章的基础上往前推进一步：

| 章节 | 主题 | 你会学到 | 核心产出 |
|:---:|------|---------|---------|
| Ch0 | 工具选型 | AI Coding Agent 的本质区别：Copilot 是副驾驶，Cursor 是增强编辑器，Claude Code 是自主 Agent | 选型决策框架 |
| Ch1 | 需求分析 | 用 Plan Mode 在写代码前想清楚架构，让 AI 帮你做技术决策 | 项目蓝图 + CLAUDE.md |
| Ch2 | 搭建脚手架 | Sequential Workflow：一步接一步的线性编排；三层配置体系 | 可运行的 CLI 骨架 |
| Ch3 | 解析 Git Diff | Explore Agent：只读子 Agent 探索代码库，上下文隔离不污染主线程 | diff_parser 模块 |
| Ch4 | Agent 设计 | Prompt 工程三要素：角色 / 能力 / 约束；如何设计专业化 Agent | 4 个审查 Agent 定义 |
| Ch5 | 并行审查 | Fan-out / Fan-in 模式：4 个 Agent 并行跑，串行 120s → 并行 30s | scheduler 并行调度器 |
| Ch6 | 结果聚合 | 三层聚合策略：拼接 → 分类 → 智能聚合；自动裁定机制 | reporter 报告生成器 |
| Ch7 | 自动化触发 | Hooks（事件驱动）+ Skills（命令封装），commit 时自动审查 | 完整自动化管线 |
| Ch8 | 测试驱动 | 给 AI 提供验证手段，TDD 循环让 AI 自我修正 | pytest 测试套件 |
| Ch9 | 模式提炼 | 从项目中提炼 6 种通用编排模式，带走复用 | 可迁移的模式库 |

每章的节奏是：先聊设计思路（为什么这样做）→ 再动手实操（跟着做一遍）→ 最后提炼成模板（方便以后复用）。

## 6 种编排模式

教程最后一章从项目中提炼出 6 种编排模式。不是纯理论分类，每一种都在前面的章节里实际用过：

| 模式 | 一句话解释 | 适用场景 | 教程对应章节 |
|:---:|-----------|---------|:----------:|
| Sequential | 步骤 A → B → C，线性执行 | 脚手架搭建、部署流水线 | Ch2 |
| Explore | 只读子 Agent 探路，不改主上下文 | 代码库调研、依赖分析 | Ch3 |
| Specialized Agent | 给 Agent 明确的角色和边界 | 安全审计、风格检查 | Ch4 |
| Fan-out / Fan-in | 多个 Agent 并行，结果汇总 | 并行审查、批量处理 | Ch5 |
| Aggregation | 多源结果分类、去重、裁定 | 报告生成、决策支持 | Ch6 |
| Event-Driven | 事件触发自动执行 | git hook、CI/CD 集成 | Ch7 |

![六种编排模式](docs/images/Gemini_Generated_Image_bp4.png)

## 4 个课后作业

教程附录提供了 4 个递进式作业，覆盖软件开发的不同环节。你可以挑选自己手头的项目作为练习对象，在熟悉的代码上实践编排思路：

| 作业 | 主题 | 难度 | 你要做什么 |
|:---:|------|:---:|-----------|
| 10a | Develop Workflow | ⭐⭐ | 从需求到代码的全流程编排，Sequential 模式热身 |
| 10b | Test Workflow | ⭐⭐⭐ | 自动生成测试套件，Fan-out 并行 + Test-Driven 循环 |
| 10c | Security Audit | ⭐⭐⭐⭐ | 安全扫描工作流，需自己设计误报控制和风险评级体系 |
| 10d | Compliance Test | ⭐⭐⭐⭐⭐ | 最综合的挑战：将网络安全法规映射到 Agent 架构 |

作业没有标准答案——编排本身就有很多种合理的做法。你需要自己选择模式、拆分 Agent、设计聚合策略，这个过程本身就是练习。

## 适合什么样的读者

如果你还没用过任何 AI 编程工具，建议先花半小时熟悉一下基本的对话式编程，再来看这篇教程。

比较适合的读者：

- 已经会用 AI 写代码，想了解下一步还能怎么用的开发者
- 听过 Agent、Workflow 这些概念，但缺一个完整案例来理解的人
- 想在团队里推广 AI 工具链，需要一套可参考的方法论的技术负责人
- 对 AI 编排感兴趣的任何人——教程里的模式不绑定特定工具

![目标读者画像](docs/images/Gemini_Generated_Image_bp5.png)

## 和常见的 AI 教程有什么不同

| | 常见 AI 编程教程 | Workflow101 |
|---|---|---|
| 关注点 | 怎么写 prompt、怎么让 AI 生成代码 | 怎么让多个 Agent 协作完成复杂任务 |
| 项目形式 | 零散的代码片段或独立小 demo | 一个完整项目贯穿始终，逐章递进 |
| 学完收获 | 一些 prompt 技巧 | 6 种编排模式 + 一个可运行的工具 |
| 工具依赖 | 通常绑定某个特定产品 | 概念通用，换工具思路不变 |
| 覆盖范围 | 侧重入门上手 | 从设计到实现、测试、自动化的完整链路 |

## 效果对比

用教程中构建的 Review Bot 审查一个 PR，和手动对话式审查相比，大致是这样的差异：

| 指标 | 手动一问一答 | Review Bot 工作流 |
|:---:|:---:|:---:|
| 审查耗时 | ~10 分钟（含来回对话） | ~30 秒（4 Agent 并行） |
| 覆盖维度 | 取决于你记得问什么 | 安全 + 性能 + 风格 + 逻辑，固定覆盖 |
| 输出格式 | 散落在聊天记录里 | 结构化报告，按严重级别分类 |
| 可复现性 | 每次问法不同，结果不同 | 同一 diff 同一结果，可审计 |
| 人工介入 | 全程手动 | git commit 自动触发，零干预 |

## 开始之前你需要准备什么

不多，三样东西：

- **Python 3.10+**——教程的示例代码基于 Python
- **一个 AI Coding Agent**——教程以 Claude Code 为例，但编排思路不绑定工具
- **大约 3 小时**——每章独立成篇，可以分多次读完，随时停下消化

## 写在最后

2024 年，很多人学会了用 AI 辅助写代码。2025 年，可以再往前走一步——学会编排 AI。

两者的区别：写代码是你告诉 AI 做什么，做完后手动搬运结果；编排是你设计好流程，AI 按流程自主运转，你看最终输出就好。

一个是工具，一个是系统。

Workflow101 想帮你建立的，是设计这种系统的能力——把复杂任务拆解成多个 Agent 的协作网络，让它们按你的设计自动运行。这种思维方式不会因为某个工具的迭代而失效。

![Workflow101 Banner](docs/images/Gemini_Generated_Image_bp6.png)

---

📖 **开始阅读**：[workflow101.readthedocs.io](https://workflow101.readthedocs.io)

⭐ **GitHub 仓库**：欢迎 Star、Fork、提 Issue

📝 **协议**：MIT，随便用

